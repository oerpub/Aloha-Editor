// Generated by CoffeeScript 1.6.3
(function() {
  define(['aloha', 'aloha/plugin', 'jquery', 'ui/ui', 'ui/button'], function(Aloha, Plugin, jQuery, UI, Button) {
    var buffer;
    buffer = '';
    return Plugin.create('copy', {
      getBuffer: function() {
        if (localStorage) {
          return localStorage.alohaOerCopyBuffer;
        } else {
          return buffer;
        }
      },
      buffer: function(content) {
        buffer = content;
        buffer = buffer.replace(/id="[^"]+"/, '');
        if (localStorage) {
          localStorage.alohaOerCopyBuffer = buffer;
        }
        return jQuery('.action.paste').fadeIn('fast');
      },
      init: function() {
        var plugin,
          _this = this;
        plugin = this;
        return Aloha.bind('aloha-editable-created', function(e, params) {
          if (localStorage && localStorage.alohaOerCopyBuffer) {
            jQuery('.action.paste').fadeIn('fast');
          }
          return jQuery('.action.paste').unbind('click').click(function(e) {
            var range;
            e.preventDefault();
            range = Aloha.Selection.getRangeObject();
            return GENTICS.Utils.Dom.insertIntoDOM(jQuery(plugin.getBuffer()), range, Aloha.activeEditable.obj);
          });
        });
      }
    });
  });

}).call(this);
